<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    //缓存：cache

    //缓存的作用，就是将一些常用的数据，存储起来，提供使用，提升性

    //CDN Content Delivery Network

    //数据库  高并发
    //非关系型数据库（内存型数据库） MongoDB  Redis

    //网站静态页面缓存机制
    //将网页静态化，存储在服务器端

    //定义一个缓存数组，存储已经计算出来的斐波那契数
    //1.计算的步骤
    //1.先从cache数组中去取想要获取的数字
    //2.如果获取到了，直接使用
    //3.如果没有获取到，就去计算，计算完之后，把计算结果存入cache，然后将结果返回

    // var cache = [];
    // function fib(n) {
    //     // 先获取数组中的结果
    //     if(cache[n] !== undefined) {
    //         // 如果有，直接返回结果
    //         return cache[n];
    //     }
    //     // 没有，就计算并加到数组中
    //     if(n <= 2) {
    //         cache[n] = 1;
    //         return 1;
    //     }
    //     var temp = fib(n-1) + fib(n-2);
    //     // 别忘了计算完要加进数组
    //     cache[n] = temp;
    //     return temp;
    // }

    var count = 0;
    // 进一步改进，利用闭包将缓存数组私有化
    function foo() {
        // 定义缓存数组
        var cache = [];

        function fib(n) {


            if(cache[n] !== undefined) {
                return cache[n];
            }
            count ++;
            if(n <= 2) {
                cache[n] = 1
                return 1;
            }
            var temp = fib(n-1) + fib(n-2);
            cache[n] = temp;
            return temp;
        }

        return fib;
    }

    // 测试
    var fib = foo();
    console.log(fib(20));
    console.log(count);
</script>
</body>
</html>